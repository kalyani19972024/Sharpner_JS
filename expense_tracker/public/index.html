<!DOCTYPE html>
<html>
<head><title>Expense Tracker</title></head>
<body>
  <h2>Signup</h2>
  <input id="name" placeholder="Name"><br>
  <input id="email" placeholder="Email"><br>
  <input id="password" placeholder="Password" type="password"><br>
  <button onclick="signup()">Sign Up</button>

  <h2>Login</h2>
  <input id="loginEmail" placeholder="Email"><br>
  <input id="loginPassword" placeholder="Password" type="password"><br>
  <button onclick="login()">Login</button>

  <h2>Add Expense</h2>
  <input id="amount" placeholder="Amount"><br>
  <input id="category" placeholder="Category"><br>
  <button onclick="addExpense()">Add Expense</button>

  <h3>Expenses</h3>
  <ul id="expenseList"></ul>

  <script>
    let token = '';

    async function signup() {
      const res = await fetch('/api/auth/signup', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          name: name.value,
          email: email.value,
          password: password.value
        })
      });
      alert(await res.text());
    }

    async function login() {
      const res = await fetch('/api/auth/login', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          email: loginEmail.value,
          password: loginPassword.value
        })
      });
      const data = await res.json();
      token = data.token;
      alert('Login successful!');
      getExpenses();
    }

    async function addExpense() {
      const res = await fetch('/api/expenses', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          Authorization: `Bearer ${token}`
        },
        body: JSON.stringify({
          amount: amount.value,
          category: category.value
        })
      });
      await getExpenses();
    }

    async function getExpenses() {
      const res = await fetch('/api/expenses', {
        headers: { Authorization: `Bearer ${token}` }
      });
      const data = await res.json();
      expenseList.innerHTML = data.expenses.map(e => `<li>${e.category}: â‚¹${e.amount}</li>`).join('');
    }
  </script>
</body>
</html>
